/*++----------------------------------------------------------------------------------------------------------------------------------------------------------------------
1. 项目名称：ares
2. 文件名：src -> application -> controllers -> dubbo -> demo -> apiProvider.js
3. 作者：zhaohuagang@lifang.com
4. 备注：dubbo接口调用范例
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------++*/

/*++-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
加载配置及工具
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------++*/
import AppApiControllerBasic from "../../api" ;
/*++-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
创建一个apiProvider实例
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------++*/
class RestfulApi extends AppApiControllerBasic {
    constructor(req, res, next) {
        super(req, res, next) ;        
        this.outputs() ;       
    }
    /*++-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    输出数据
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------++*/
    async outputs() {
        /*++-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
        下面是单个dubbo接口的调用
        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------++*/
        /*
        this.SOAServices.AgentHouseService.serviceAgentHouses(100237).then( (data) => {   
            data.message = "zhaohuagang" ;         
            this.jsonObject = data ;              
            this.output() ;
        }).catch( (e) => {
            this.jsonObject.message = "error name : " + e.name + " , error message : " + e.message ;               
            this.output() ;
        }) ;
        */
        /*++-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
        下面是多个dubbo接口的调用
        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------++*/   
        Promise.all( [ 
            this.SOAServices.AgentHouseService.serviceAgentHouses(100237) , 
            this.SOAServices.AgentHouseService.serviceAgentHouses(100238)
        ] )
        .then((results) => {
            this.jsonObject = {
                a : results[0] , 
                b : results[1]
            } ;
            this.output() ;
        })
        .catch((e) => {
            this.jsonObject.message = "Name : "+ e[0].name + " , Message : " + e[0].message  ;
            this.output() ;
        }) ;
        /*++-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
        结束
        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------++*/ 
        

    }
    
}

export default RestfulApi ;